---
title: "Umgang mit kleinen Stichproben in der psychologischen Forschung"
subtitle: "<br/>Probelehrveranstaltung"
author: "Andreas Brandmaier"
institute: ""
#date: "`r Sys.Date()`"
date: "2021-03-04"
output:
  xaringan::moon_reader:
    css: [default,  "extra.css","sydney.css", "sydney-fonts.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      beforeInit: "jquery-3.5.1.js" 
---
  
```{r xaringanExtra, echo=FALSE, message=FALSE, warning=FALSE}
#xaringanExtra::use_xaringan_extra(c( "animate_css", "tachyons"))

library(here)
library(tidyverse)
library(ggx)
#source(here("R/scripts.R"))
source("R/scripts.R")
source("R/powerplot.R")
```

# Ziel der Inferenzstatistik

.hide[fill]
.hide[fill]

.larger[
  
.read_more[Um aus Daten einer begrenzten Anzahl Personen auf eine große Anzahl von Menschen schließen kann, befassen wir uns mit der Inferenzstatistik.] 
  
Unser Anspruch an die Inferenz:
    
.read_more[Generalisierbar]
  
.read_more[Präzise]
  
]

---
# Teststärke

.pull-left[
<br>
.larger[
.emph[Statistische Teststärke] (_power_):  die Wahrscheinlichkeit, dass ein Test einen real existierenden Effekt einer angenommenen Größe entdeckt
]
]

.pull-right[
![](images/thomas-kelley-74096-unsplash.jpg)
]

---

# Wiederholung: Was ist die Teststärke?

<br>
```{r fig.width=12, fig.height=6, echo=FALSE, warning=FALSE}
power_plot(FALSE)
```

---
# Wiederholung: Was ist die Teststärke?

<br>
```{r fig.width=12, fig.height=6, echo=FALSE}
power_plot(TRUE)
```

---
  
# Determinanten der Teststärke
  <br>
.larger[Statistische Teststärke ist eine Funktion von]
  <br>
.read_more[Effektstärke] (Beispielsweise, der wahre Zusammenhang zweier Merkmale, der wahre Gruppenunterschied)

--

.read_more[Irrtumswahrscheinlichkeit] (Typischerweise 5%)

--

.read_more[Präzision] (Messfehler)

--

.read_more[Stichprobengröße]

--
---

# Probleme geringer Teststärke
<br><br>
.read_more[] Geringe Teststärke ist ein Problem für Sie, da die .emph[Unsicherheit] hoch bleibt und wir die Wahrscheinlichkeit für .emph[Fehler zweiter Art], d.h., ihre Chancen wahre Effekte zu verpassen steigt

- Verschwendung von Forschungsgeldern und Zeit
- Unnötige Belastung von Probanden ist ethisch bedenklich

--

.read_more[] Geringe Teststärke ist ein Problem für ein Forschungsfeld, da die Wahrscheinlichkeit, dass berichtete Effekte falsch sind steigt, d.h, die Anzahl der .emph[Falsch-Positiven Befunde] steigt)

--

.read_more[] _Der Fluch des Gewinners_ führt oft dazu, dass berichtete Effektstärken zu groß sind.






---


# Probleme geringer Teststärke

<br>
Wir fragen uns: Welcher Anteil von Studien, die ein signifikantes Ergebnis (Nullhypothese abgelehnt) berichten irren:

<br>
Teststärke: Pr(H0 abgelehnt | H0 ist falsch)

Falschpositivrate: Pr(H0 ist falsch | H0 abgelehnt)

--

$$\textrm{Pr(H0 falsch | H0 abgelehnt)}=\frac{\textrm{Pr(H0 abgelehnt | H0 falsch)} \cdot \textrm{Pr(H0 falsch) }}{\textrm{Pr(H0 abgelehnt)}}$$

$$\propto \frac{Teststärke \cdot Pr(\textrm{H0 falsch}) }{ \alpha \cdot \textrm{Pr(H0 wahr})}$$
---

# Illustration der FPR

.pull-left[
Effekt existiert (H0 ist falsch)
```{r echo=FALSE, fig.height=4, fig.width=4}
# H0 is false, Effekt existiert, wird aber nur selten gefunden
# 20% heißt 10 in 50
ballsplot(10,50, "H0 ist falsch (Effekt existiert)")
```
]

.pull.right[
Kein Effekt (H0 ist wahr)
```{r echo = FALSE, fig.height=3, fig.width=3}
# H0 is true, no effect, that is, we get only alpha error, 5%
# 5% heißt 2.5 in 50
ballsplot(2,50,"H0 ist wahr (Kein Effekt)")
```
]

FPR = `compute.ppv(power=.20, alpha=.05, r=.5)`

---

# Illustration der PPV

.pull-left[
Effekt existiert (H0 ist falsch)
```{r echo=FALSE}
# H0 is false, Effekt existiert, wird aber nur selten gefunden
# 20% heißt 10 in 50
ballsplot(4, 20, "H0 ist falsch (Effekt existiert)")
```
]

.pull.right[
Kein Effekt (H0 ist wahr)
```{r echo = FALSE}
# H0 is true, no effect, that is, we get only alpha error, 5%
# 5% heißt 2.5 in 50
ballsplot(4, 80, "H0 ist wahr (Kein Effekt)")
```
]

FPR = `compute.ppv(power=.20, alpha=.05, r=.2)`

---

class:segue-large-red

.large[Welche Auswege gibt es?]

---

# Auswege 

- Meta-Analyse zur Zusammenführung der Informationen aus mehreren kleinen Stichproben


# Meta-Analyse

Meta-analysis hilft uns, zu quantifizieren, wie sehr wir angesichts der Evidenz aus mehreren Studien an einen Effekt glauben können

```{r, echo=FALSE, message=FALSE}
require("MASS")
set.seed(4295)
r <- -0.3
test <- function(N) {
data <- mvrnorm(N,mu=c(0,0), Sigma=matrix(c(1,r,r,1),nrow=2))
cor.test(data[,1],data[,2])
}
N1 <- 50
N2 <- 43
N3 <- 55
t1 <- test(N=N1)
t2 <- test(N=N2)
t3 <- test(N=N3)
```

Ein ausgedachtes Beispiel:

- Forscher*in A untersucht den Zusammenhang von IQ and Depression in einer Stichprobe von `N1` Personen und findet einen nicht-signifikanten Zusammenhang (r=`r round(t1$p.value,2)`, n.s.)

-- 

- Forscher*in B berichtet mit einer Stichprobengröße von `N2` ebenfalls einen nicht-signifikanten Effekt (r=`r round(t2$p.value,2)`, n.s.)

--

- Forscher*in C berichten mit einer Stichprobengröße `N3` erneut (r=`r round(t3$p.value,2)`, n.s.)

--

.emph[Wie stark zweifeln Sie nun an der Existenz des Effekts?]

---

class: segue-large-blue

.larger[Stichprobengröße ist nicht alles....]

.quote[It is more useful to study one animal for 1000 hours than to study 1000 animals for one hour - B.F.Skinner, zitiert in Kerlinger & Lee (1999)]
]
---

# $N$=1

- Klassischerweise sprechen wir meist über die Stichprobengröße als primäre Stellschraube für die Größe einer Studie

- Messungen kann man aber auch statt über Individuen auch "innerhalb" von Individuen (also über die Zeit hinweg) verteilen

.pull-left[

- Die Psychologie hat verschiedene Erfolgsbeispiele, bspw. die .emph[Ebbinghaussche Kurve], die den Grad des Vergessens über einen Zeitraum angibt und im Selbstversuch 1885 entdeckt  wurde
]

.pull-right[
```{r echo=FALSE, results='hide'}
x<-c(0, .25, .5, .75, 1,  2,3,4,5,6 ,  7)
y<-c(100,80, 60, 40 , 35, 29,28,27,26,25   , 24)

ggplot(data=data.frame(x,y),aes(x=x,y=y))+#geom_line()+
  xlab("Tage")+ylab("Erinnerungsleistung")+ylim(0,100)+
  geom_smooth(method="gam",se=FALSE,lwd=2)+
  theme_light()+theme(axis.title.x=element_text(size=20))+
  theme(axis.title.y=element_text(size=20))
```
.quote[Schematisch]
]

---

# Validität der Inferenz

Welche Frage wollen wir eigentlich beantworten?

Beispiel: Wir interessieren uns für den Zusammenhang von IQ und Alkoholkonsum

```{r}
plot_withinbetween(with.between=TRUE, with.within = FALSE)
```

---
# Validität der Inferenz

Welche Frage wollen wir eigentlich beantworten?

Beispiel: Wir interessieren uns für den Zusammenhang von IQ und Alkoholkonsum

```{r}
plot_withinbetween(with.between=TRUE, with.within = TRUE)
```

---

class: seque

.large[Optimales Design]

---

# Zusammenfassung

Zwei zentrale Gedanken zur .emph[kleine Stichprobengrößen]:

- Validität
- Präzision (Statistische Teststärke)

--

.read_more[Planen] Sie Studien mit Sorgfalt unter Beachtung dieser Aspekte
.read_more[Meta-Analysen] für bereits existierende Daten (aber achten Sie auf mögliche Schubladeneffekte)
